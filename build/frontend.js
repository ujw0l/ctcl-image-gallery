(()=>{"use strict";class e{constructor(e,t){Array.from(document.querySelectorAll(e)).map((e=>{this.createGal(e,t)}))}createGal(e,t){let i=null!=t&&null!=t.imageEvent?t.imageEvent:"click",l=null!=t&&null!=t.mainImgWd?t.mainImgWd:e.offsetWidth,r=null!=t&&null!=t.mainImgHt?t.mainImgHt:e.offsetHeight,n=document.createElement("div");n.classList.add("ctclig-image-list"),e.appendChild(n);let a=document.createElement("div");a.classList.add("ctclig-main-image"),a.style=`width:${l}px; height :${r}px ;background: url("") center center / contain no-repeat rgb(255, 255, 255,0.5); margin-left:auto;margin-right:auto;display: block;`,a.innerHTML=`<span style='font-size:${l/30}px;position:relative; top: ${r/2-5}px; left: ${l/2-5}px ;' >Loading ...</span>`,n.appendChild(a);let o=document.createElement("div");o.style.width=`${l}px`,o.classList.add("ctclig-image-cont"),o.style.overflowX="auto",o.style.overflowY="hidden",o.style.marginLeft="auto",o.style.marginRight="auto",o.style.display="block";let d=document.createElement("div");d.style.width="0px",d.style.marginLeft="auto",d.style.marginRight="auto",d.style.display="block",o.appendChild(d),n.appendChild(o),Array.from(e.querySelectorAll("img")).map(((e,t)=>{e.style.display="none";let l=new Image;l.src=e.src,l.addEventListener("load",(e=>{""!=a.innerHTML&&(a.innerHTML="",a.setAttribute("data-num",t),a.style.backgroundImage=`url("${e.target.src}")`);let l=e.target.width/e.target.height*70;d.style.width=`${parseFloat(d.style.width)+l+4}px`,e.target.style.width=`${l}px`,e.target.setAttribute("data-img-num",t),e.target.style.height="70px",e.target.style.margin="2px",e.target.style.display="",e.target.addEventListener(i,(e=>{a.setAttribute("data-num",t),a.style.backgroundImage=`url("${e.target.src}")`})),d.appendChild(e.target)}))})),e.style.height=`${r+100}px`,null!=t&&null!=t.callBack&&t.callBack(e)}}class t{constructor(e,t){Array.from(document.querySelectorAll(e)).map(((e,i)=>this.prepareGal(e,i,t))),window.addEventListener("resize",(e=>this.adjustApp(e))),window.addEventListener("keydown",(e=>this.onKeyStroke(e))),this.ssIntervalId=0}prepareGal(e,t){let i=Array.from(e.querySelectorAll("img"));i.forEach(((e,l)=>e.addEventListener("click",(e=>this.createOverlay(event.target,l,i,t)))))}createOverlay(e,t,i,l){let r=window.innerWidth+1,n=window.innerHeight+1,a=1<i.length?.94:1,o=1<i.length?.04:0,d=document.createElement("style");d.id="ctc-scroll-css",d.innerHTML="::-webkit-scrollbar-track {background: rgba(255, 255, 255, 1);} ::-moz-scrollbar-track { background: rgba(255, 255, 255, 1);} #gal-sidebar::-webkit-scrollbar {display: none;} #gal-sidebar::-moz-scrollbar {display: none;}",document.querySelector("head").appendChild(d),document.body.style.overflow="hidden";let s=document.createElement("div");s.id="gallery-overlay",s.style=`position:fixed;height:${n}px;width:${r}px;background-color:rgba(0,0,0,.6);z-index:100000;top:0%;left:0%;right:0%;bottom:0%;`,document.body.insertBefore(s,document.body.firstChild);let c=document.createElement("span");c.id="overlay-close-btn",c.title="Close",c.innerHTML="&#10539;",c.style=`cursor:pointer;position:absolute;float:right;right:3px;font-size:${.016*r}px;color:rgba(255,255,255,1);text-shadow:-1px -1px 1px rgba(0,0,0,1);z-index:200000;`,s.appendChild(c),c.addEventListener("click",(()=>this.closeOverlay(s)));let g=document.createElement("span");g.id="image-loading-main",g.style=`left:${.992*r/2};top:${n/2};font-size:${.016*r}px;display:inline-block;position:fixed;color:rgba(255,255,255,1);`,g.innerHTML="Loading",s.appendChild(g);let m=setInterval((()=>{switch(g.innerHTML){case"Loading":case"Loading...<b>.</b>":g.innerHTML="Loading<b>.</b>";break;case"Loading<b>.</b>":g.innerHTML="Loading.<b>.</b>";break;case"Loading.<b>.</b>":g.innerHTML="Loading..<b>.</b>";break;case"Loading..<b>.</b>":g.innerHTML="Loading...<b>.</b>"}}),350),h=document.createElement("img"),p=new Image;p.src=e.src,h.id="loaded-img",h.src=e.src,h.style.display="none";let u=this.getOptimizedImageSize(r,n,p.width,p.height,i.length);p.addEventListener("load",(t=>{clearInterval(m),g.style.display="none",h.style=`z-index:180000;height:${u.height}px;width:${u.width}px;display:inline-block;margin:${(n-u.height)/2}px ${(a*r-u.width)/2}px;`,h.title=null!=e.getAttribute("title")||null!=e.getAttribute("title")?e.getAttribute("title"):""})),s.appendChild(h);let y=document.createElement("div");y.id="img-title-info",y.style=`z-index:195000;position:fixed;text-align:center;height:${.02*n}px;width:${u.width}px;bottom:1px;color:rgba(255,255,255,1);font-size:${.015*n};left:${o*r+(a*r-u.width)/2}px;`,y.innerHTML=null!=e.getAttribute("title")||null!=e.getAttribute("title")?e.getAttribute("title"):"",s.appendChild(y),1<i.length&&(this.createToolbar(s,i,h,t,l),this.createSidebar(s,i,h,t,l),h.addEventListener("click",(e=>{e.offsetX>e.target.offsetWidth/2?document.querySelector("#gal-next-img").click():document.querySelector("#gal-prev-img").click()})))}createToolbar(e,t,i,l,r){let n=e.querySelector("#toolbar-div"),a=e.offsetWidth,o=e.offsetHeight,d=t.length-1>=l+1?l+1:0,s=0<=l-1?l-1:t.length-1,c=`font-family:serif;height:${.02*a}px;width:${.02*a}px;text-align:center;font-size:${.016*a}px;cursor:pointer;color:rgba(255,255,255,1);border-radius:${.02*a}px;margin-top:${.002*a}px;background-color:rgba(0,0,0,0.8);`;if(null==n){let l=document.createElement("div");l.id="toolbar-div",l.style=`top:${o/1.6-.077*a}px;float:right; transform: translateY(-50%); right: 0px;display: inline-block;position: fixed;`;let r=document.createElement("div");r.id="gal-prev-img",r.style=c,r.innerHTML="&#60;",r.title="Previous image",r.addEventListener("click",(l=>this.loadImg(parseInt(l.target.getAttribute("data-img-num")),t,e,i))),r.setAttribute("data-img-num",s),r.addEventListener("mouseenter",(e=>e.target.style.fontWeight="bolder")),r.addEventListener("mouseleave",(e=>e.target.style.fontWeight="")),l.insertBefore(r,l.firstChild);let n=document.createElement("div");n.id="img-zoom-in",n.style=c,n.innerHTML="&#43;",n.title="Zoom in",n.addEventListener("click",(()=>i.style.transform=0===i.style.transform.length?"scale(1.2)":`scale(${parseFloat(i.style.transform.replace("scale(","").replace(")",""))+.2})`)),n.addEventListener("mouseenter",(e=>e.target.style.fontWeight="bolder")),n.addEventListener("mouseleave",(e=>e.target.style.fontWeight="")),l.appendChild(n);let g=document.createElement("div");g.id="img-zoom-out",g.style=c,g.innerHTML="&#8722;",g.title="Zoom out",g.addEventListener("click",(()=>{let e=parseFloat(i.style.transform.replace("scale(","").replace(")",""))-.2,t=0>e?.1:e;i.style.transform=0===i.style.transform.length?"scale(0.8)":`scale(${t})`})),g.addEventListener("mouseenter",(e=>e.target.style.fontWeight="bolder")),g.addEventListener("mouseleave",(e=>e.target.style.fontWeight="")),l.appendChild(g);let m=document.createElement("div");m.id="gal-next-img",m.style=c,m.innerHTML="&#62;",m.title="Next image",m.addEventListener("click",(l=>this.loadImg(parseInt(l.target.getAttribute("data-img-num")),t,e,i))),m.setAttribute("data-img-num",d),m.addEventListener("mouseenter",(e=>e.target.style.fontWeight="bolder")),m.addEventListener("mouseleave",(e=>e.target.style.fontWeight="")),l.appendChild(m),e.appendChild(l)}else{let t=e.querySelector("#image-loading-main");null!=t&&e.removeChild(t),n.querySelector("#gal-prev-img").setAttribute("data-img-num",s),n.querySelector("#gal-next-img").setAttribute("data-img-num",d)}}createSidebar(e,t,i,l,r){let n=document.createElement("div");n.id="gal-sidebar",n.style=`overflow-y:auto;tex-align:center;display:inline-block;width:${.04*e.offsetWidth}px;height:${e.offsetHeight}px;float:left;left:0;background-color:rgba(0,0,0,0.1);z-index:105000;`,e.appendChild(n);let a=`overflow-x: hidden;transition: width 0.5s, height 0.5s;cursor:pointer;background-color:rgba(255,255,255,1);width:93%;height:${.93*n.offsetWidth}px;border:1px dotted rgba(0,0,0,0.8);background-repeat: no-repeat;background-size:contain;background-position: center;text-align:center;color:rgba(0,0,0,1);font-size:${.6*n.offsetWidth}px;`;t.map(((l,r)=>{let o=new Image;o.src=l.src;let d=document.createElement("div");d.classList.add("img-preview"),d.title=null!=l.getAttribute("title")||null!=l.getAttribute("title")?l.getAttribute("title"):"",d.style=a,d.addEventListener("mouseenter",(e=>e.target.style.borderRadius="12%")),d.addEventListener("mouseleave",(e=>e.target.style.borderRadius="5%")),d.innerHTML="<b>.</b>",n.appendChild(d);let s=setInterval((()=>{switch(d.innerHTML){case"<b>.</b>":d.innerHTML="<b>.</b>.";break;case"<b>.</b>.":d.innerHTML=".<b>.</b>.";break;case".<b>.</b>.":d.innerHTML="...<b>.</b>";break;case"...<b>.</b>":d.innerHTML="<b>.</b>"}}),250);o.addEventListener("load",(e=>{clearInterval(s),d.innerHTML="",d.style.backgroundImage=`url('${e.target.src}')`})),d.addEventListener("click",(()=>this.loadImg(r,t,e,i)))})),this.scrollToPrev(l),n.style.paddingTop=0<(e.offsetHeight-t.length*(.93*n.offsetWidth+2))/2?(e.offsetHeight-t.length*(.93*n.offsetWidth+2))/2+"px":"0px"}loadImg(e,t,i,l){var r=new Image;r.src=t[e].src,l.src=t[e].src,l.style.display="none";let n=document.createElement("span");n.id="image-loading-main",n.style=`left:${.992*i.offsetWidth/2};top:${i.offsetHeight/2};font-size:${.016*i.offsetWidth}px;display:inline-block;position:fixed;color:rgba(255,255,255,1);`,n.innerHTML="Loading",i.appendChild(n);let a=setInterval((()=>{switch(n.innerHTML){case"Loading":case"Loading...<b>.</b>":n.innerHTML="Loading<b>.</b>";break;case"Loading<b>.</b>":n.innerHTML="Loading.<b>.</b>";break;case"Loading.<b>.</b>":n.innerHTML="Loading..<b>.</b>";break;case"Loading..<b>.</b>":n.innerHTML="Loading...<b>.</b>"}}),350),o=this.getOptimizedImageSize(i.offsetWidth,i.offsetHeight,r.width,r.height,t.length);r.addEventListener("load",(()=>{clearInterval(a),n.style.display="none",l.style=`z-index:180000;height:${o.height}px;width:${o.width}px;display:inline-block;margin:${(i.offsetHeight-o.height)/2}px ${(.94*i.offsetWidth-o.width)/2}px;`,l.title=null!=t[e].getAttribute("title")||null!=t[e].getAttribute("title")?t[e].getAttribute("title"):""}));let d=document.querySelector("#img-title-info");d.style.overflow,d.innerHTML=null!=t[e].getAttribute("title")||null!=t[e].getAttribute("title")?t[e].getAttribute("title"):"",d.style.width=o.width+"px",d.style.left=.04*i.offsetWidth+(.94*i.offsetWidth-o.width)/2+"px",this.createToolbar(i,t,l,e),this.scrollToPrev(e)}scrollToPrev(e){Array.from(document.querySelectorAll(".img-preview")).forEach(((t,i)=>{i===e?(t.scrollIntoView({block:"center"}),t.style.border="1px solid rgba(255, 0, 0, 0.8)"):t.style.border="1px solid rgba(0,0,0,0.8)"}))}adjustApp(e){let t=window.innerWidth,i=window.innerHeight,l=document.querySelector("#gallery-overlay");if(null!=l){let e=l.querySelector("#overlay-close-btn");l.style.height=`${i}px`,l.style.width=`${t}px`,e.style.fontSize=""+.016*t;let r=document.querySelector("#loaded-img"),n=document.querySelector("#gal-sidebar"),a=null!=n?2:1,o=null!=n?.94:1,d=null!=n?.04:0,s=l.querySelector("#image-loading-main");s.style.left=""+.992*t/2,s.style.top=""+i/2,s.style.fontSize=.016*t+"px";let c=new Image;c.src=r.src;let g=this.getOptimizedImageSize(t,i,c.width,c.height,a),m=r.style.display;r.style=`height:${g.height}px;width:${g.width}px;display:${m};margin:${(i-g.height)/2}px ${(o*t-g.width)/2}px;`;let h=document.querySelector("#img-title-info");if(h.style.overflow="hidden",h.style.width=g.width+"px",h.style.height=.02*i+"px",h.style.left=d*t+(o*t-g.width)/2+"px",h.style.fontSize=.015*i+"px",null!=n){let e=Array.from(n.querySelectorAll("div"));n.style.height=i+"px",n.style.width=.04*t+"px",n.style.paddingTop=0<(i-e.length*(.93*n.offsetWidth+2))/2?(i-e.length*(.93*n.offsetWidth+2))/2+"px":"0px",e.map((e=>{e.style.height=.93*n.offsetWidth+"px",e.style.fontSize=.6*n.offsetWidth+"px"}));let r=l.querySelector("#toolbar-div");r.style=`top:${i/1.8-.077*t}px;float:right;right: 0px;display: inline-block;position: fixed;`,Array.from(r.querySelectorAll("div")).map((e=>{e.style.height=.02*t+"px",e.style.width=.02*t+"px",e.style.borderRadius=.02*t+"px",e.style.marginTop=.002*t+"px",e.style.fontSize="gal-slide-show"!=e.id?.016*t+"px":.011*t+"px"}))}}}closeOverlay(e){let t=e.querySelector("#gal-slide-show");null!=t&&0<parseInt(t.getAttribute("data-interval-id"))&&clearInterval(parseInt(t.getAttribute("data-interval-id"))),document.body.removeChild(e),document.body.style.overflow="",document.body.style.margin="",document.querySelector("head").removeChild(document.querySelector("#ctc-scroll-css"))}getOptimizedImageSize(e,t,i,l,r){let n=0,a=0,o=0,d=0,s=null!=r&&1<r?.93:.955,c=1-s;if(i>=e&&l>=t)i>=l?i>l?(a=i/e,d=i/a-c*e,o=l*(d/i),o>=s*t&&(n=t/l,o=l*n-c*t,d=i*(o/l))):e>t?(o=s*t,d=o):t>e?(d=s*e,o=d):(n=t/l,o=l*n-c*t,d=i*(o/l)):(n=l/t,o=l/n-c*t,d=i*(o/l));else if(i>=e&&l<t)a=e/i,d=i*a-c*e,o=l*(d/i);else if(l>=t&&i<e)n=t/l,o=l*n-c*t,d=i*(o/l),o=l*(d/i);else{let r=s*e,a=s*t;i>=r&&l>=a?(imgAvlHtRatio=a/l,d=r*(r/i),o=t*n):i>=r&&l<a?(d=i*(r/i),o=l*(d/i)):l>=a&&i<r?(o=l*(a/l),d=i*(o/l)):(d=i,o=l),o=l*(d/i)}return d>s*e&&(d=s*e,o=l*(d/i)),{width:d,height:o}}onKeyStroke(e){let t=document.querySelector("#gallery-overlay");if(null!=t)switch(e.code){case"ArrowUp":document.querySelector("#img-zoom-in").click();break;case"ArrowDown":document.querySelector("#img-zoom-out").click();break;case"ArrowLeft":document.querySelector("#gal-prev-img").click();break;case"ArrowRight":document.querySelector("#gal-next-img").click();break;case"Escape":t.querySelector("#overlay-close-btn").click()}}}window.addEventListener("DOMContentLoaded",(()=>{new e(".ctcl-gallery",{imageEvent:"mousemove",callBack:e=>{e.style.opacity="",e.querySelector(".ctclig-main-image").addEventListener("click",(e=>e.target.parentElement.querySelector(`img[data-img-num='${e.target.getAttribute("data-num")}']`).click())),setTimeout((()=>new t(`#ctcl-gallery-${e.getAttribute("data-clntid")} .ctclig-image-list`)),5e3)}})}))})();